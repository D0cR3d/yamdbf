{"version":3,"sources":["command/base/usagecontrol/Groups.ts"],"names":[],"mappings":"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","file":"Groups.js","sourcesContent":["import { Message } from '../../../types/Message';\nimport { Command } from '../../Command';\nimport { localizable, using } from '../../CommandDecorators';\nimport { ResourceLoader } from '../../../types/ResourceLoader';\nimport { BaseStrings as s } from '../../../localization/BaseStrings';\nimport { Middleware } from '../../middleware/Middleware';\nimport { Lang } from '../../../localization/Lang';\nconst { resolve, expect, } = Middleware;\n\nexport default class extends Command\n{\n\tpublic constructor()\n\t{\n\t\tsuper({\n\t\t\tname: 'groups',\n\t\t\tdesc: 'Configure or list command groups',\n\t\t\tusage: `<prefix>groups ['enable'|'on'|'disable'|'off'] [...group]`,\n\t\t\tinfo: `A '*' denotes a disabled group when listing all command groups.`,\n\t\t\tcallerPermissions: ['ADMINISTRATOR']\n\t\t});\n\t}\n\n\t@using(resolve(`action: ['enable', 'on', 'disable', 'off'], ...group: String`))\n\t@using(function(message, args: string[])\n\t{\n\t\tif (args[0])\n\t\t\treturn expect(`action: ['enable', 'on', 'disable', 'off'], ...group: String`)\n\t\t\t\t.call(this, message, args);\n\t\telse return [message, args];\n\t})\n\t@localizable\n\tpublic async action(message: Message, [res, action, group]: [ResourceLoader, string, string]): Promise<any>\n\t{\n\t\tif (!action) return this.listGroups(message, res);\n\t\telse if (['enable', 'on'].includes(action)) return this.enableGroup(message, res, group);\n\t\telse if (['disable', 'off'].includes(action)) return this.disableGroup(message, res, group);\n\t}\n\n\t/**\n\t * List command groups\n\t */\n\tprivate async listGroups(message: Message, res: ResourceLoader): Promise<void>\n\t{\n\t\tconst lang: string = await message.guild.storage.settings.get('lang') || this.client.defaultLang;\n\t\tconst info: string[] = this.client.commands.groups.map(g => Lang.getGroupInfo(g, lang));\n\t\tconst disabledGroups: string[] = await message.guild.storage.settings.get('disabledGroups') || [];\n\n\t\tconst output: string = res(s.CMD_GROUPS_LIST, {\n\t\t\tgroups: this.client.commands.groups.join(', '),\n\t\t\tdisabledGroups: disabledGroups.join(', '),\n\t\t\tinfo: info.join('::::')\n\t\t});\n\n\t\tthis.respond(message, output);\n\t}\n\n\t/**\n\t * Enable a command group\n\t */\n\tprivate async enableGroup(message: Message, res: ResourceLoader, group: string): Promise<any>\n\t{\n\t\tconst err: { [error: string]: string } = {\n\t\t\tNO_EXIST: res(s.CMD_GROUPS_ERR_NOEXIST, { group }),\n\t\t\tENABLED: res(s.CMD_GROUPS_ERR_ENABLED, { group })\n\t\t};\n\n\t\tif (!this.client.commands.groups.includes(group)) return this.respond(message, err.NO_EXIST);\n\t\tconst disabledGroups: string[] = await message.guild.storage.settings.get('disabledGroups') || [];\n\t\tif (group === 'base' || !disabledGroups.includes(group))\n\t\t\treturn this.respond(message, err.ENABLED);\n\n\t\tdisabledGroups.splice(disabledGroups.indexOf(group), 1);\n\t\tawait message.guild.storage.settings.set('disabledGroups', disabledGroups);\n\n\t\tthis.respond(message, res(s.CMD_GROUPS_ENABLE_SUCCESS, { group }));\n\t}\n\n\t/**\n\t * Disable a command group\n\t */\n\tprivate async disableGroup(message: Message, res: ResourceLoader, group: string): Promise<any>\n\t{\n\t\tconst err: { [error: string]: string } = {\n\t\t\tNO_EXIST: res(s.CMD_GROUPS_ERR_NOEXIST, { group }),\n\t\t\tDISABLED: res(s.CMD_GROUPS_ERR_DISABLED, { group })\n\t\t};\n\n\t\tif (!this.client.commands.groups.includes(group)) return this.respond(message, err.NO_EXIST);\n\t\tconst disabledGroups: string[] = await message.guild.storage.settings.get('disabledGroups') || [];\n\t\tif (group === 'base' || disabledGroups.includes(group))\n\t\t\treturn this.respond(message, err.DISABLED);\n\n\t\tdisabledGroups.push(group);\n\t\tawait message.guild.storage.settings.set('disabledGroups', disabledGroups);\n\n\t\tthis.respond(message, res(s.CMD_GROUPS_DISABLE_SUCCESS, { group }));\n\t}\n}\n"],"sourceRoot":"../../../../src"}